{% extends "teacher/index.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %}System System - Change Password{% endblock %}


{% block page_content %}
<div class="col-lg-6 col-lg-push-2">
<div class="page-header">
  <h2>修改邮箱: </h2>
</div>
    <di class="col-lg-6">
        <form action="" method="post" class="form" role="form">
        <div class="form-group  required">
            <label>{{ form.old_email.label }}</label>
            {{ form.old_email(class="form-control", id="get_email") }}
        </div>
        <div class="form-group  required">
            <label>{{ form.new_email.label }}</label>
            {{ form.new_email(class="form-control") }}
        </div>
        {{ form.verify_code.label }}
        <div class="input-group required">
            {{ form.verify_code(class="form-control") }}
            <div class="input-group-btn">
                <button class="btn btn-default" id="sendVerifyCode" type="button" onclick="countdownHandler()">获取验证码</button>
            </div>
        </div>
        <br>
        {{ form.submit(class="btn btn-default") }}
    </form>
    </di>
</div>
<script>
        //短信验证码倒计时
    var countdownHandler = function(){
        var btn = document.getElementById("sendVerifyCode");
        var number = 5;
        var email = $("#get_email").val();
        if (email == 0)
        {
            alert("邮箱为空!")
            return;
        }
        else
        {
            $.get("{{ url_for('teacher.send_code_email') }}",{'email':email}, function (data)
            {
                if(data['data'] == 0){
                    alert("邮箱不存在")
                    return;
                }
                else
                {
                    var countdown = function()
                    {
                        if (number == 0) {
                            btn.innerHTML = '发送验证码';
                            number = 5;
                            $("#sendVerifyCode").attr("disabled",false);
                            return;
                        } else {
                            btn.setAttribute("disabled",true);
                            btn.innerHTML = number + "秒 重新发送";
                            number--;
                            }
                        setTimeout(countdown,1000);
                    }
                    setTimeout(countdown,1000);
                }
            })
        }
    }
</script>
{% endblock %}










